from selenium import webdriver
from selenium.webdriver.chrome import service as fs
from selenium.webdriver.common.by import By
from selenium.webdriver.remote.webelement import WebElement
from time import sleep


DRIVER_PASS = "driver/chromedriver.exe"
TARGET_URL = "https://www.jec.ac.jp"
NUMS_IMG = 10

def save_img(elm: WebElement, file: str):
    with open(file, 'wb') as f:
        f.write(elm.screenshot_as_png)

chrome_service = fs.Service(DRIVER_PASS)
chrome_option = webdriver.ChromeOptions()
chrome_option.add_experimental_option("excludeSwitches", ["enable-Logging"])
chrome_driver = webdriver.Chrome(service=chrome_service, options=chrome_option)

chrome_driver.get(TARGET_URL)
chrome_driver.maximize_window()
sleep(2)
    
# 不要なポップアップを非表示
try:
    elm_popup = chrome_driver.find_element(By.XPATH, "/html/body/div[1]/div[4]/div/h2/span")
    chrome_driver.execute_script("arguments[0].setAttribute('style','display: none;')", elm_popup)
except:
    print("ポップアップはありませんでした")
    

for i in range(1, NUMS_IMG+1):
    xpath_img = f"/html/body/div[1]/div[4]/div/a[{i}]"
    file_img = f"img/日本電子専門学校_コース{i}.png"
    elm_img = chrome_driver.find_element(By.XPATH, xpath_img)
    save_img(elm_img, file_img)
